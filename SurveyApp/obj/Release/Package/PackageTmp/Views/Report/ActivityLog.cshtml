@using System.Data;
@{
    Layout = "~/Views/Shared/_Layout.cshtml";

    ViewBag.Title = "eBit - Account Request(s)";

    DataSet ds = SurveyApp.DataHelper.getActivityLog();
}



<style type="text/css">
    .requests .name {
        text-transform: capitalize;
    }
    
</style>

<script type="text/javascript">
    $(function () {
        $("#tblActivityLog").DataTable(
            {
                dom: 'Bfrtip',
                buttons: [{
                    extend: 'excel',
                    text: "Export to Excel",
                    title: 'Respondents_Activity_Log',
                    exportOptions: {
                        modifier: {
                            search: 'none',
                            order: 'original'
                        }
                    }
                }],
                "oLanguage": {
                    "sInfo": "Displaying _START_ to _END_ of _TOTAL_ Respondent(s)"
                },
                "order": [[3, "desc"]]
            });
    });
</script>

<h2>
    <a href="javascript:void(0);" id="back" onclick="history.go(-1);"></a> &nbsp;Respondents Activity Log
</h2>

<div class="activitylog">
    <table class="table table-striped table-hover" id="tblActivityLog">
        <thead>
            <tr>
                <th class="name">Name</th>
                <th class="email">Email</th>
                <th class="name">School</th>                
                <th class="comments">Total Surveys Submitted</th>
                <th class="date">No. of Associated Children</th>
                <th class="action">Last Login Date</th>
            </tr>
        </thead>
        <tbody>
            @if (ds != null && ds.Tables.Count > 0)
            {
                foreach (DataRow dr in ds.Tables[0].Rows)
                {
                    <tr>
                        <td class="name">@dr["FullName"]</td>
                        <td class="email">@dr["Email"]</td>
                        <td class="name">@dr["School"]</td>                        
                        <td class="comments">@dr["SurveysSubmitted"]</td>
                        <td class="comments">@dr["AssociatedChildren"]</td>
                        <td class="date">@(dr["LastLoginDate"] != DBNull.Value ? Convert.ToDateTime(dr["LastLoginDate"]).ToString("MM/dd/yyyy") : "")</td>                        
                    </tr>
                }
            }
        </tbody>
    </table>
</div>
